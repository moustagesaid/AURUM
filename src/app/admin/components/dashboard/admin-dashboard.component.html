<div class="dashboard-container">
  <!-- Luxury Sidebar (icon-only) -->
  <aside class="sidebar">
    <div class="sidebar-logo">
      <span class="logo-mark">A</span>
    </div>

    <nav class="sidebar-nav">
      <button
        type="button"
        class="nav-icon-button"
        [class.active]="activeSection === 'overview'"
        (click)="setActiveSection('overview')"
        title="Overview"
      >
        <span class="nav-icon">â—†</span>
      </button>

      <button
        type="button"
        class="nav-icon-button"
        [class.active]="activeSection === 'analytics'"
        (click)="setActiveSection('analytics')"
        title="Analytics"
      >
        <span class="nav-icon">ðŸ“ˆ</span>
      </button>

      <button
        type="button"
        class="nav-icon-button"
        [class.active]="activeSection === 'products'"
        (click)="setActiveSection('products')"
        title="Product Vault"
      >
        <span class="nav-icon">âš—</span>
      </button>
    </nav>

    <div class="sidebar-footer">
      <button class="nav-icon-button logout" type="button" (click)="logout()" title="Logout">
        <span class="nav-icon">âŸµ</span>
      </button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <header class="content-header">
      <div>
        <h1 class="page-title">Dashboard Overview</h1>
        <p class="page-subtitle">AURUM Back Office Â· Curating the experience behind every drop</p>
      </div>
      <div class="header-meta">
        <span class="last-updated">Last updated: {{ !isLoading ? 'Just now' : 'Loading...' }}</span>
      </div>
    </header>

    <!-- Top: Analytics Grid -->
    <section class="analytics-section">
      <div class="analytics-grid">
        <!-- Total Revenue -->
        <article class="glass-card analytics-card">
          <div class="analytics-icon">ðŸ’Ž</div>
          <div class="analytics-label">TOTAL REVENUE</div>
          <div class="analytics-value revenue">
            ${{ displayRevenue | number : '1.0-0' }}
          </div>
          <div class="analytics-subtext">Lifetime sales across all fragrances</div>
        </article>

        <!-- Total Orders -->
        <article class="glass-card analytics-card">
          <div class="analytics-icon">ðŸ“¦</div>
          <div class="analytics-label">TOTAL ORDERS</div>
          <div class="analytics-value">
            {{ displayOrders | number : '1.0-0' }}
          </div>
          <div class="analytics-subtext">Completed and in-progress orders</div>
        </article>

        <!-- Conversion Rate -->
        <article class="glass-card analytics-card">
          <div class="analytics-icon">â˜¾</div>
          <div class="analytics-label">CONVERSION RATE</div>
          <div class="analytics-value">
            {{ displayConversionRate | number : '1.0-1' }}%
          </div>
          <div class="analytics-subtext">Orders per unique customer profile</div>
        </article>
      </div>
    </section>

    <!-- Middle: Sales Analysis Chart -->
    <section class="sales-section">
      <article class="glass-card sales-card">
        <div class="card-header">
          <h2 class="card-title">Sales Trajectory</h2>
          <span class="card-subtitle">Recent revenue performance</span>
        </div>
        <div class="chart-wrapper">
          <canvas #salesChart></canvas>
        </div>
      </article>
    </section>

    <!-- Product Vault + Recent Activity -->
    <section class="lower-grid">
      <!-- Product Vault -->
      <article class="glass-card vault-card">
        <div class="card-header">
          <h2 class="card-title">Enroll New Fragrance</h2>
          <span class="card-subtitle">Curate a new signature into the public collection</span>
        </div>

        <form (ngSubmit)="onAddProduct()" #vaultForm="ngForm" class="vault-form">
          <div class="field-row">
            <div class="field-group">
              <label class="floating-label">
                <span class="label-text">Fragrance Name</span>
                <input
                  type="text"
                  name="name"
                  [(ngModel)]="newProduct.name"
                  required
                  placeholder=" "
                />
              </label>
            </div>
          </div>

          <div class="field-row">
            <div class="field-group">
              <label class="floating-label">
                <span class="label-text">Price (USD)</span>
                <input
                  type="number"
                  name="price"
                  [(ngModel)]="newProduct.price"
                  required
                  min="0"
                  step="0.01"
                  placeholder=" "
                />
              </label>
            </div>
          </div>

          <div class="field-row">
            <div class="field-group">
              <label class="floating-label">
                <span class="label-text">Bottle Artwork URL</span>
                <input
                  type="text"
                  name="image"
                  [(ngModel)]="newProduct.image"
                  required
                  placeholder=" "
                />
              </label>
            </div>
          </div>

          <button
            class="vault-submit"
            type="submit"
            [disabled]="vaultForm.invalid || isSavingProduct"
          >
            {{ isSavingProduct ? 'Publishing...' : 'Publish to Collection' }}
          </button>

          <div class="form-message success" *ngIf="productSuccessMessage">
            {{ productSuccessMessage }}
          </div>
          <div class="form-message error" *ngIf="productErrorMessage">
            {{ productErrorMessage }}
          </div>
        </form>
      </article>

      <!-- Recent Activity -->
      <article class="glass-card activity-card">
        <div class="card-header">
          <h2 class="card-title">Recent Activity</h2>
          <span class="card-subtitle">Last 5 customer orders</span>
        </div>

        <div class="activity-table">
          <div class="activity-header">
            <span>ID</span>
            <span>Customer</span>
            <span>Total</span>
            <span>Status</span>
            <span>Date</span>
          </div>

          <div
            class="activity-row"
            *ngFor="let order of recentOrders"
          >
            <span>#{{ order.id }}</span>
            <span>{{ order.customerName }}</span>
            <span>${{ order.total }}</span>
            <span>
              <span
                class="status-pill"
                [ngClass]="{
                  'status-pending': order.status?.toLowerCase() === 'pending',
                  'status-shipped': order.status?.toLowerCase() === 'shipped'
                }"
              >
                {{ order.status }}
              </span>
            </span>
            <span>{{ order.date }}</span>
          </div>
        </div>
      </article>
    </section>
  </main>
</div>